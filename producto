{% assign selected_variant = product.selected_or_first_available_variant %}

{% for media in product.media %}
  {% render 'product-media', media: media %}
{% endfor %}

{% form 'product', product, id: 'product-form', novalidate: 'novalidate', class: 'product-form' %}
  <input type="hidden" name="id" value="{{ selected_variant.id }}" aria-hidden="true">

  {% for block in section.blocks %}
    {% case block.type %}
      {% when 'vendor' %}
        <div class="product-vendor">{{ product.vendor }}</div>
      {% when 'title' %}
        <h1 class="product-title">{{ product.title }}</h1>
      {% when 'price' %}
        <div id="price-{{ section.id }}" class="product-price">
          <span class="compare-price">{{ selected_variant.compare_at_price | money }}</span>
          <span class="selling-price">{{ selected_variant.price | money }}</span>
          {% if selected_variant.price < selected_variant.compare_at_price %}
            <span class="sale-badge">En Oferta</span>
          {% endif %}
        </div>
      {% when 'variant_selector' %}
        {% unless product.has_only_default_variant %}
          <variant-selector data-url="{{ product.url }}" data-section="{{ section.id }}" class="variant-selector">
            {% for option in product.options_with_values %}
              <label for="option-{{ section.id }}-{{ forloop.index0 }}">{{ option.name }}</label>
              <select name="options[{{ option.name | escape }}]" id="option-{{ section.id }}-{{ forloop.index0 }}">
                {% for value in option.values %}
                  <option value="{{ value | escape }}" {% if option.selected_value == value %} selected="selected" {% endif %}>{{ value }}</option>
                {% endfor %}
              </select>
            {% endfor %}
            <script type="application/json">
              {{ product.variants | json }}
            </script>
          </variant-selector>
        {% endunless %}
      {% when 'quantity' %}
        <label for="quantity-{{ section.id }}">Cantidad</label>
        <input type="number" name="quantity" id="quantity-{{ section.id }}" value="1" min="1" class="quantity-input">
      {% when 'description' %}
        <p class="product-description">{{ product.description }}</p>
      {% when 'checkout_buttons' %}
        <button type="submit" name="add" class="add-to-cart-button" {% if selected_variant.available == false %} disabled {% endif %}>
          {% if selected_variant.available == false %}
              Agotado
          {% else %}
              Añadir al Carrito
          {% endif %}
        </button>
      {% else %}
        <!-- Otros tipos de bloques pueden ser añadidos aquí -->
    {% endcase %}
  {% endfor %}
{% endform %}
